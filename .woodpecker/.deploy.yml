# .woodpecker.yml
steps:
  - name: build & copy
    image: node:18-alpine
    when:
      - branch: master
        event: push
    environment:
      CLOUDFLARE_ACCOUNT_ID:
        from_secret: CLOUDFLARE_ACCOUNT_ID
      CLOUDFLARE_API_TOKEN:
        from_secret: CLOUDFLARE_API_TOKEN
    commands:
      - npm install
      - npm run build
      - npm install --save-dev
      - npx wrangler pages deploy "./build/" --project-name blog --branch master --commit-dirty
    secrets: [CLOUDFLARE_ACCOUNT_ID, CLOUDFLARE_API_TOKEN]
